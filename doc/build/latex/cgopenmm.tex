%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,12pt,english,openany,oneside]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{Coarse-grained OpenMM Documentation}
\date{Sep 18, 2019}
\release{0.0.1}
\author{Garrett A. Meek\\ \\Michael R. Shirts\\ \\Dept. of Chemical and Biological Engineering\\University of Colorado Boulder}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


This documentation is generated automatically using Sphinx, which reads all docstring-formatted comments from Python functions in the ‘cg\_openmm’ repository.  (See cg\_openmm/doc for Sphinx source files.)


\chapter{Building OpenMM objects for coarse grained modeling}
\label{\detokenize{build:building-openmm-objects-for-coarse-grained-modeling}}\label{\detokenize{build::doc}}
All \sphinxhref{http://openmm.org}{OpenMM} simulations require a \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()} and a \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1topology\_1\_1Topology.html}{Topology()}.  This chapter details procedures for building those objects for coarse grained models with user-defined properties.


\section{Building an OpenMM System() for a coarse grained model.}
\label{\detokenize{build:building-an-openmm-system-for-a-coarse-grained-model}}
An OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()} object contains force definitions for a molecular model.  The ‘cg\_openmm’ repository applies default definitions for all forces (see \sphinxhref{http://docs.openmm.org/development/userguide/theory.html}{OpenMM user guide} for detailed definitions).

Shown below are tools and functions needed to build and verify an OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()} .

\phantomsection\label{\detokenize{build:module-build.cg_build}}\index{build.cg\_build (module)@\spxentry{build.cg\_build}\spxextra{module}}\index{build\_system() (in module build.cg\_build)@\spxentry{build\_system()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.build_system}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{build\_system}}}{\emph{cgmodel}}{}
Builds an OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()} object, given a CGModel() as input.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() class object

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
system ( \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()} ) - OpenMM System() object

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{build\PYGZus{}system}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system} \PYG{o}{=} \PYG{n}{system}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{verify\_system() (in module build.cg\_build)@\spxentry{verify\_system()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.verify_system}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{verify\_system}}}{\emph{cgmodel}}{}
Given a CGModel() class object, this function confirms that its OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()} object is configured correctly.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() class object

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{verify\PYGZus{}system}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{warning}{Warning:}
The function will force an error exit if the system is invalid, and will proceed as normal if the system is valid.
\end{sphinxadmonition}

\end{fulllineitems}


\newpage


\section{Building an OpenMM Topology() for a coarse grained model.}
\label{\detokenize{build:building-an-openmm-topology-for-a-coarse-grained-model}}
An OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1topology\_1\_1Topology.html}{Topology()} object contains structural definitions for a molecular model (bond assignments, residue assignments, etc.).

Shown below are tools and functions needed to build and verify an OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1topology\_1\_1Topology.html}{Topology()} .

\phantomsection\label{\detokenize{build:module-build.cg_build}}\index{build.cg\_build (module)@\spxentry{build.cg\_build}\spxextra{module}}\index{build\_topology() (in module build.cg\_build)@\spxentry{build\_topology()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.build_topology}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{build\_topology}}}{\emph{cgmodel}, \emph{use\_pdbfile=False}, \emph{pdbfile=None}}{}
Construct an OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1topology\_1\_1Topology.html}{Topology()} class object for our coarse grained model,
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() class object

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{use\_pdbfile}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Determines whether or not to use a PDB file in order to generate the Topology().

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{pdbfile}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Name of a PDB file to use when building the topology.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
topology (\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1topology\_1\_1Topology.html}{Topology()} ) - OpenMM Topology() object

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{util}\PYG{n+nn}{.}\PYG{n+nn}{iotools} \PYG{k}{import} \PYG{n}{write\PYGZus{}pdbfile\PYGZus{}without\PYGZus{}topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{input\PYGZus{}pdb} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{top.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{write\PYGZus{}pdbfile\PYGZus{}without\PYGZus{}topology}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{,}\PYG{n}{input\PYGZus{}pdb}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{build\PYGZus{}topology}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{,}\PYG{n}{use\PYGZus{}pdbfile}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}\PYG{n}{pdbfile}\PYG{o}{=}\PYG{n}{input\PYGZus{}pdb}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology} \PYG{o}{=} \PYG{n}{topology}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{warning}{Warning:}
When ‘use\_pdbfile’=True, this function will use the \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1pdbfile\_1\_1PDBFile.html}{PDBFile()} class object from OpenMM to build the Topology().  In order for this approach to function correctly, the particle names in the PDB file must match the particle names in the coarse grained model.
\end{sphinxadmonition}

\end{fulllineitems}

\index{verify\_topology() (in module build.cg\_build)@\spxentry{verify\_topology()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.verify_topology}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{verify\_topology}}}{\emph{cgmodel}}{}
Given a coarse grained model that contains a Topology() (cgmodel.topology), this function verifies the validity of the topology.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() class object.

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{verify\PYGZus{}topology}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{warning}{Warning:}
The function will force an error exit if the topology is invalid, and will proceed as normal if the topology is valid.
\end{sphinxadmonition}

\end{fulllineitems}


\newpage


\section{Configuring OpenMM Forces() for a coarse grained model.}
\label{\detokenize{build:configuring-openmm-forces-for-a-coarse-grained-model}}
The ‘cg\_openmm’ package contains multiple tools for verifying the validity of forces that are added to an OpenMM System().  These tools are shown below:

\phantomsection\label{\detokenize{build:module-build.cg_build}}\index{build.cg\_build (module)@\spxentry{build.cg\_build}\spxextra{module}}\index{add\_force() (in module build.cg\_build)@\spxentry{add\_force()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.add_force}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{add\_force}}}{\emph{cgmodel}, \emph{force\_type=None}}{}
Given a ‘cgmodel’ and ‘force\_type’ as input, this function adds
the OpenMM force corresponding to ‘force\_type’ to ‘cgmodel.system’.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} \textendash{} CGModel() class object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{type}} \textendash{} class

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{force\_type}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Designates the kind of ‘force’ provided. (Valid options include: “Bond”, “Nonbonded”, “Angle”, and “Torsion”)

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
cgmodel (class) - ‘foldamers’ CGModel() class object

\item {} 
force (class) - An OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1Force.html}{Force()} object.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{force\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Bond}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel}\PYG{p}{,}\PYG{n}{force} \PYG{o}{=} \PYG{n}{add\PYGZus{}force}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{,}\PYG{n}{force\PYGZus{}type}\PYG{o}{=}\PYG{n}{force\PYGZus{}type}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{test\_force() (in module build.cg\_build)@\spxentry{test\_force()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.test_force}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{test\_force}}}{\emph{cgmodel}, \emph{force}, \emph{force\_type=None}}{}
Given an OpenMM \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1Force.html}{Force()}, this function determines if there are any problems with its configuration.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() class object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{force}} \textendash{} An OpenMM Force() object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{force\_type}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Designates the kind of ‘force’ provided. (Valid options include: “Nonbonded”)

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
‘success’ (Logical) - a variable indicating if the force test passed.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk}\PYG{n+nn}{.}\PYG{n+nn}{openmm}\PYG{n+nn}{.}\PYG{n+nn}{openmm} \PYG{k}{import} \PYG{n}{NonbondedForce}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{force} \PYG{o}{=} \PYG{n}{NonbondedForce}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{force\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Nonbonded}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{test\PYGZus{}result} \PYG{o}{=} \PYG{n}{test\PYGZus{}force}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{,}\PYG{n}{force}\PYG{p}{,}\PYG{n}{force\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Nonbonded}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{test\_forces() (in module build.cg\_build)@\spxentry{test\_forces()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.test_forces}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{test\_forces}}}{\emph{cgmodel}}{}
Given a cgmodel that contains positions and an
an OpenMM System() object, this function tests 
the forces for cgmodel.system.

More specifically, this function confirms that the
model does not have any “NaN” or unphysically large forces.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} \textendash{} CGModel() class object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{type}} \textendash{} class

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
success (Logical) - Indicates if this cgmodel has unphysical forces.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{pass\PYGZus{}forces\PYGZus{}test} \PYG{o}{=} \PYG{n}{test\PYGZus{}forces}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_num\_forces() (in module build.cg\_build)@\spxentry{get\_num\_forces()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.get_num_forces}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{get\_num\_forces}}}{\emph{cgmodel}}{}
Given a CGModel() class object, this function determines how many forces we are including when evaluating the energy.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() class object

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
total\_forces (int) - Number of forces in the coarse grained model

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}number\PYGZus{}forces} \PYG{o}{=} \PYG{n}{get\PYGZus{}num\PYGZus{}forces}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}


\newpage


\section{Other tools for building and verifying the OpenMM System() and Topology()}
\label{\detokenize{build:other-tools-for-building-and-verifying-the-openmm-system-and-topology}}
Shown below are other utilities to build and verify a coarse grained model System()/Topology() for OpenMM:

\phantomsection\label{\detokenize{build:module-build.cg_build}}\index{build.cg\_build (module)@\spxentry{build.cg\_build}\spxextra{module}}\index{add\_new\_elements() (in module build.cg\_build)@\spxentry{add\_new\_elements()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.add_new_elements}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{add\_new\_elements}}}{\emph{cgmodel}}{}
Add coarse grained particle types to OpenMM.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel object (contains all attributes for a coarse grained model).

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
particle\_list (list) - a list of the particles that were added to OpenMM’s ‘Element’ List.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{particle\PYGZus{}types} \PYG{o}{=} \PYG{n}{add\PYGZus{}new\PYGZus{}elements}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{warning}{Warning:}
If the particle names were user defined, and any of the names conflict with existing element names in OpenMM, OpenMM will issue an error exit.
\end{sphinxadmonition}

\end{fulllineitems}

\index{write\_xml\_file() (in module build.cg\_build)@\spxentry{write\_xml\_file()}\spxextra{in module build.cg\_build}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{build:build.cg_build.write_xml_file}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{build.cg\_build.}}\sphinxbfcode{\sphinxupquote{write\_xml\_file}}}{\emph{cgmodel}, \emph{xml\_file\_name}}{}
Write an XML-formatted forcefield file for a coarse grained model.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() class object.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{xml\_file\_name}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to XML output file.

\end{itemize}

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{xml\PYGZus{}file\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{openmm\PYGZus{}cgmodel.xml}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{write\PYGZus{}xml\PYGZus{}file}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{,}\PYG{n}{xml\PYGZus{}file\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}



\chapter{OpenMM simulation tools for coarse grained modeling}
\label{\detokenize{simulation:openmm-simulation-tools-for-coarse-grained-modeling}}\label{\detokenize{simulation::doc}}

\section{Building OpenMM Simulation() objects}
\label{\detokenize{simulation:building-openmm-simulation-objects}}
OpenMM simulations are propagated using a \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1simulation\_1\_1Simulation.html}{Simulation()} object.

Shown below are the main tools needed to build OpenMM Simulaton() objects for coarse grained modeling.

\phantomsection\label{\detokenize{simulation:module-simulation.tools}}\index{simulation.tools (module)@\spxentry{simulation.tools}\spxextra{module}}\index{build\_mm\_simulation() (in module simulation.tools)@\spxentry{build\_mm\_simulation()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.build_mm_simulation}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{build\_mm\_simulation}}}{\emph{topology}, \emph{system}, \emph{positions}, \emph{temperature=Quantity(value=300.0}, \emph{unit=kelvin)}, \emph{simulation\_time\_step=None}, \emph{total\_simulation\_time=Quantity(value=1.0}, \emph{unit=picosecond)}, \emph{output\_pdb=None}, \emph{output\_data=None}, \emph{print\_frequency=100}, \emph{test\_time\_step=False}}{}
Build an OpenMM Simulation()
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} (\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1topology\_1\_1Topology.html}{Topology()}) \textendash{} OpenMM Topology()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} (\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()}) \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} (\sphinxhref{https://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ( np.array( {[}cgmodel.num\_beads,3{]} ), simtk.unit )) \textendash{} Positions array for the model we would like to test

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature}} (\sphinxhref{https://simtk.org/}{SIMTK} \sphinxhref{http://docs.openmm.org/7.1.0/api-python/generated/simtk.unit.unit.Unit.html}{Unit()}) \textendash{} Simulation temperature, default = 300.0 K

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_pdb}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output destination for PDB coordinates, Default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_data}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output destination for non-coordinate simulation data, Default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} \textendash{} Number of simulation steps to skip when writing to output, Default = 100

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{test\_time\_step}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Logical variable determining if a test of the time step will be performed, Default = False

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
simulation ( \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1simulation\_1\_1Simulation.html}{Simulation()} ) - OpenMM Simulation() object

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mf}{300.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{kelvin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{picosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}pdb} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}data} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.dat}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{print\PYGZus{}frequency} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{openmm\PYGZus{}simulation} \PYG{o}{=} \PYG{n}{build\PYGZus{}mm\PYGZus{}simulation}\PYG{p}{(}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{system}\PYG{p}{,}\PYG{n}{positions}\PYG{p}{,}\PYG{n}{temperature}\PYG{o}{=}\PYG{n}{temperature}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{o}{=}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{,}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{o}{=}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{p}{,}\PYG{n}{output\PYGZus{}pdb}\PYG{o}{=}\PYG{n}{output\PYGZus{}pdb}\PYG{p}{,}\PYG{n}{output\PYGZus{}data}\PYG{o}{=}\PYG{n}{output\PYGZus{}data}\PYG{p}{,}\PYG{n}{print\PYGZus{}frequency}\PYG{o}{=}\PYG{n}{print\PYGZus{}frequency}\PYG{p}{,}\PYG{n}{test\PYGZus{}time\PYGZus{}step}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{run\_simulation() (in module simulation.tools)@\spxentry{run\_simulation()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.run_simulation}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{run\_simulation}}}{\emph{cgmodel}, \emph{output\_directory}, \emph{total\_simulation\_time}, \emph{simulation\_time\_step}, \emph{temperature}, \emph{print\_frequency}, \emph{output\_pdb=None}, \emph{output\_data=None}}{}
Run OpenMM() simulation
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() object

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_directory}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output directory for simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature}} \textendash{} Simulation temperature, default = 300.0 K

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} \textendash{} Number of simulation steps to skip when writing to output, Default = 100

\end{itemize}

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mf}{300.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{kelvin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{picosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}directory} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{getcwd}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}pdb} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}data} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.dat}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{print\PYGZus{}frequency} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{run\PYGZus{}simulation}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{,}\PYG{n}{output\PYGZus{}directory}\PYG{p}{,}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{,}\PYG{n}{temperature}\PYG{p}{,}\PYG{n}{print\PYGZus{}frequency}\PYG{p}{,}\PYG{n}{output\PYGZus{}pdb}\PYG{o}{=}\PYG{n}{output\PYGZus{}pdb}\PYG{p}{,}\PYG{n}{output\PYGZus{}data}\PYG{o}{=}\PYG{n}{output\PYGZus{}data}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{warning}{Warning:}
When run with default options this subroutine is capable of producing a large number of output files.  For example, by default this subroutine will plot the simulation data that is written to an output file.
\end{sphinxadmonition}

\end{fulllineitems}


\newpage


\section{Running Yank replica exchange simulations}
\label{\detokenize{simulation:running-yank-replica-exchange-simulations}}
The \sphinxhref{http://getyank.org/0.23.4/index.html}{Yank} python package is used to perform replica exchange sampling with OpenMM simulations.

Shown below are the main functions and tools necessary to conduct Yank replica exchange simulations with a coarse grained model in OpenMM.

\phantomsection\label{\detokenize{simulation:module-simulation.rep_exch}}\index{simulation.rep\_exch (module)@\spxentry{simulation.rep\_exch}\spxextra{module}}\index{run\_replica\_exchange() (in module simulation.rep\_exch)@\spxentry{run\_replica\_exchange()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.run_replica_exchange}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{run\_replica\_exchange}}}{\emph{topology}, \emph{system}, \emph{positions}, \emph{temperature\_list=None}, \emph{simulation\_time\_step=None}, \emph{total\_simulation\_time=Quantity(value=1.0}, \emph{unit=picosecond)}, \emph{output\_data='output.nc'}, \emph{print\_frequency=100}, \emph{verbose\_simulation=False}, \emph{exchange\_attempts=None}, \emph{test\_time\_step=False}, \emph{output\_directory=None}}{}
Run a Yank replica exchange simulation using an OpenMM coarse grained model.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} \textendash{} Positions array for the model we would like to test

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_list}} \textendash{} List of temperatures for which to perform replica exchange simulations, default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}) \textendash{} Name of NETCDF file where we will write simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} \textendash{} Number of simulation steps to skip when writing to output, Default = 100

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{verbose\_simulation}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Determines how much output is printed during a simulation run.  Default = False

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{exchange\_attempts}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} Number of exchange attempts to make during a replica exchange simulation run, Default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{test\_time\_step}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Logical variable determining if a test of the time step will be performed, Default = False

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_directory}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to which we will write the output from simulation runs.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
replica\_energies ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ( np.float( {[}number\_replicas,number\_simulation\_steps{]} ), simtk.unit ) ) - The potential energies for all replicas at all (printed) time steps

\item {} 
replica\_positions ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ( np.float( {[}number\_replicas,number\_simulation\_steps,cgmodel.num\_beads,3{]} ), simtk.unit ) ) - The positions for all replicas at all (printed) time steps

\item {} 
replica\_state\_indices ( np.int64( {[}number\_replicas,number\_simulation\_steps{]} ), simtk.unit ) - The thermodynamic state assignments for all replicas at all (printed) time steps

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{cg\PYGZus{}openmm}\PYG{n+nn}{.}\PYG{n+nn}{simulation}\PYG{n+nn}{.}\PYG{n+nn}{rep\PYGZus{}exch} \PYG{k}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{run\PYGZus{}replica\PYGZus{}exchange}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{read\_replica\_exchange\_data() (in module simulation.rep\_exch)@\spxentry{read\_replica\_exchange\_data()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.read_replica_exchange_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{read\_replica\_exchange\_data}}}{\emph{system=None}, \emph{topology=None}, \emph{temperature\_list=None}, \emph{output\_data='output.nc'}, \emph{print\_frequency=None}}{}
Read replica exchange simulation data.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} \textendash{} OpenMM system object, default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM topology object, default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_list}} \textendash{} List of temperatures that will be used to define different replicas (thermodynamics states), default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_data}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to the output data for a Yank, NetCDF-formatted file containing replica exchange simulation data, default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} Number of simulation steps to skip when writing data, default = None

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
replica\_energies ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ( np.float( {[}number\_replicas,number\_simulation\_steps{]} ), simtk.unit ) ) - The potential energies for all replicas at all (printed) time steps

\item {} 
replica\_positions ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ( np.float( {[}number\_replicas,number\_simulation\_steps,cgmodel.num\_beads,3{]} ), simtk.unit ) ) - The positions for all replicas at all (printed) time steps

\item {} 
replica\_state\_indices ( np.int64( {[}number\_replicas,number\_simulation\_steps{]} ), simtk.unit ) - The thermodynamic state assignments for all replicas at all (printed) time steps

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{cg\PYGZus{}openmm}\PYG{n+nn}{.}\PYG{n+nn}{simulation}\PYG{n+nn}{.}\PYG{n+nn}{rep\PYGZus{}exch} \PYG{k}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{run\PYGZus{}replica\PYGZus{}exchange}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{read\PYGZus{}replica\PYGZus{}exchange\PYGZus{}data}\PYG{p}{(}\PYG{n}{system}\PYG{o}{=}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{topology}\PYG{o}{=}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{temperature\PYGZus{}list}\PYG{o}{=}\PYG{p}{,}\PYG{n}{output\PYGZus{}data}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.nc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{print\PYGZus{}frequency}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{make\_replica\_pdb\_files() (in module simulation.rep\_exch)@\spxentry{make\_replica\_pdb\_files()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.make_replica_pdb_files}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{make\_replica\_pdb\_files}}}{\emph{topology}, \emph{replica\_positions}}{}
Make PDB files from replica exchange simulation trajectory data
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_positions}} \textendash{} Positions array for the replica exchange data for which we will write PDB files

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
file\_list ( List( str ) ) - A list of names for the files that were written

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{cg\PYGZus{}openmm}\PYG{n+nn}{.}\PYG{n+nn}{simulation}\PYG{n+nn}{.}\PYG{n+nn}{rep\PYGZus{}exch} \PYG{k}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{run\PYGZus{}replica\PYGZus{}exchange}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{pdb\PYGZus{}file\PYGZus{}list} \PYG{o}{=} \PYG{n}{make\PYGZus{}replica\PYGZus{}pdb\PYGZus{}files}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}


\newpage


\section{Tools to plot coarse grained model simulation results}
\label{\detokenize{simulation:tools-to-plot-coarse-grained-model-simulation-results}}
The ‘cg\_openmm’ package contains multiple functions to plot OpenMM and Yank simulation results using \sphinxhref{https://matplotlib.org/}{matplotlib} .

Shown below is example output from a Yank replica exchange simulation run:

\noindent\sphinxincludegraphics{{replica_exchange_energies}.png}

\noindent\sphinxincludegraphics{{replica_exchange_transitions}.png}

Shown below are functions which allow plotting of simulation results.

\phantomsection\label{\detokenize{simulation:module-simulation.rep_exch}}\index{simulation.rep\_exch (module)@\spxentry{simulation.rep\_exch}\spxextra{module}}\index{plot\_replica\_exchange\_energies() (in module simulation.rep\_exch)@\spxentry{plot\_replica\_exchange\_energies()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.plot_replica_exchange_energies}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{plot\_replica\_exchange\_energies}}}{\emph{replica\_energies}, \emph{temperature\_list}, \emph{simulation\_time\_step}, \emph{steps\_per\_stage=1}, \emph{file\_name='rep\_ex\_ener.png'}, \emph{legend=True}, \emph{output\_directory=None}}{}
Plot the potential energies for a batch of replica exchange trajectories
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_energies}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{float * simtk.unit.energy for simulation\_steps}}\sphinxstyleliteralemphasis{\sphinxupquote{ ) }}\sphinxstyleliteralemphasis{\sphinxupquote{for num\_replicas}}\sphinxstyleliteralemphasis{\sphinxupquote{ )}}) \textendash{} List of dimension num\_replicas X simulation\_steps, which gives the energies for all replicas at all simulation steps

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_list}} \textendash{} List of temperatures for which to perform replica exchange simulations, default = {[}(300.0 * unit.kelvin).\_\_add\_\_(i * unit.kelvin) for i in range(-20,100,10){]}

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{steps\_per\_stage}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} The number of simulation steps for individual replica “stages” (period of time between state exchanges), default = 1

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{file\_name}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} The pathname of the output file for plotting results, default = “replica\_exchange\_energies.png”

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_directory}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to which we will write the output from simulation runs, Default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{legend}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Controls whether a legend is added to the plot

\end{itemize}

\end{description}\end{quote}

..warning:: If more than 10 replica exchange trajectories are provided as input data, by default, this function will only plot the first 10 thermodynamic states.  These thermodynamic states are chosen based upon their indices, not their instantaneous temperature (ensemble) assignment.

\end{fulllineitems}

\index{plot\_replica\_exchange\_summary() (in module simulation.rep\_exch)@\spxentry{plot\_replica\_exchange\_summary()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.plot_replica_exchange_summary}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{plot\_replica\_exchange\_summary}}}{\emph{replica\_states}, \emph{temperature\_list}, \emph{simulation\_time\_step}, \emph{steps\_per\_stage=1}, \emph{file\_name='rep\_ex\_states.png'}, \emph{legend=True}, \emph{output\_directory=None}}{}
Plot the thermodynamic state assignments for individual temperature replicas as a function of the simulation time, in order to obtain a visual summary of the replica exchanges from a Yank simulation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_states}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{float * simtk.unit.energy for simulation\_steps}}\sphinxstyleliteralemphasis{\sphinxupquote{ ) }}\sphinxstyleliteralemphasis{\sphinxupquote{for num\_replicas}}\sphinxstyleliteralemphasis{\sphinxupquote{ )}}) \textendash{} List of dimension num\_replicas X simulation\_steps, which gives the thermodynamic state indices for all replicas at all simulation steps

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_list}} \textendash{} List of temperatures for which to perform replica exchange simulations, default = {[}(300.0 * unit.kelvin).\_\_add\_\_(i * unit.kelvin) for i in range(-20,100,10){]}

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{steps\_per\_stage}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} The number of simulation steps for individual replica “stages” (period of time between state exchanges), default = 1

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{file\_name}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} The pathname of the output file for plotting results, default = “replica\_exchange\_state\_transitions.png”

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{legend}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Controls whether a legend is added to the plot

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_directory}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to which we will write the output from simulation runs, default = None

\end{itemize}

\end{description}\end{quote}

..warning:: If more than 10 replica exchange trajectories are provided as input data, by default, this function will only plot the first 10 thermodynamic states.  These thermodynamic states are chosen based upon their indices, not their instantaneous temperature (ensemble) assignment.

\end{fulllineitems}

\phantomsection\label{\detokenize{simulation:module-simulation.tools}}\index{simulation.tools (module)@\spxentry{simulation.tools}\spxextra{module}}\index{plot\_simulation\_data() (in module simulation.tools)@\spxentry{plot\_simulation\_data()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.plot_simulation_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{plot\_simulation\_data}}}{\emph{simulation\_times}, \emph{y\_data}, \emph{plot\_type=None}, \emph{output\_directory=None}}{}
Plot simulation data.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_times}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} List of simulation times (x data)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} List of simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{plot\_type}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Form of data to plot, Default = None, Valid options include: “Potential Energy”, “Kinetic Energy”, “Total Energy”, “Temperature”

\end{itemize}

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}data\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}data} \PYG{o}{=} \PYG{n}{read\PYGZus{}simulation\PYGZus{}data}\PYG{p}{(}\PYG{n}{simulation\PYGZus{}data\PYGZus{}file}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}times} \PYG{o}{=} \PYG{n}{simulation\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Simulation Time}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{y\PYGZus{}data} \PYG{o}{=} \PYG{n}{simulation\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Potential Energy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{plot\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Potential Energy}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{plot\PYGZus{}simulation\PYGZus{}data}\PYG{p}{(}\PYG{n}{simulation\PYGZus{}times}\PYG{p}{,}\PYG{n}{y\PYGZus{}data}\PYG{p}{,}\PYG{n}{plot\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Potential Energy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{plot\_simulation\_results() (in module simulation.tools)@\spxentry{plot\_simulation\_results()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.plot_simulation_results}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{plot\_simulation\_results}}}{\emph{simulation\_data\_file}, \emph{plot\_output\_directory}, \emph{simulation\_time\_step}}{}
Plot all data from an OpenMM output file
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_data\_file}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to file containing simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{plot\_output\_directory}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to folder where plotting results will be written.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\end{itemize}

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}data\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{plot\PYGZus{}output\PYGZus{}directory} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{getcwd}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{plot\PYGZus{}simulation\PYGZus{}results}\PYG{p}{(}\PYG{n}{simulation\PYGZus{}data\PYGZus{}file}\PYG{p}{,}\PYG{n}{plot\PYGZus{}output\PYGZus{}directory}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}


\newpage


\section{Other simulation tools}
\label{\detokenize{simulation:other-simulation-tools}}
Shown below are other tools which aid the building and verification of OpenMM simulation objects.

\phantomsection\label{\detokenize{simulation:module-simulation.tools}}\index{simulation.tools (module)@\spxentry{simulation.tools}\spxextra{module}}\index{get\_mm\_energy() (in module simulation.tools)@\spxentry{get\_mm\_energy()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.get_mm_energy}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{get\_mm\_energy}}}{\emph{topology}, \emph{system}, \emph{positions}}{}
Get the OpenMM potential energy for a system, given a topology and set of positions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} \textendash{} Positions array for the model we would like to test

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
potential\_energy ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ) - The potential energy for the model with the provided positions.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{openmm\PYGZus{}potential\PYGZus{}energy} \PYG{o}{=} \PYG{n}{get\PYGZus{}mm\PYGZus{}energy}\PYG{p}{(}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{system}\PYG{p}{,}\PYG{n}{positions}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_simulation\_time\_step() (in module simulation.tools)@\spxentry{get\_simulation\_time\_step()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.get_simulation_time_step}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{get\_simulation\_time\_step}}}{\emph{topology}, \emph{system}, \emph{positions}, \emph{temperature}, \emph{total\_simulation\_time}, \emph{time\_step\_list=None}}{}
Determine a suitable simulation time step.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} \textendash{} Positions array for the model we would like to test

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature}} \textendash{} Simulation temperature

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{time\_step\_list}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default = None}}) \textendash{} List of time steps for which to attempt a simulation in OpenMM.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
time\_step ( \sphinxhref{https://simtk.org/}{SIMTK} \sphinxhref{http://docs.openmm.org/7.1.0/api-python/generated/simtk.unit.unit.Unit.html}{Unit()} ) - A successfully-tested simulation time-step for the provided coarse grained model

\item {} 
tolerance ( \sphinxhref{https://simtk.org/}{SIMTK} \sphinxhref{http://docs.openmm.org/7.1.0/api-python/generated/simtk.unit.unit.Unit.html}{Unit()} ) - The maximum change in forces that will be tolerated when testing the time step.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mf}{300.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{kelvin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}simulation\PYGZus{}time} \PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{picosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{time\PYGZus{}step\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}\PYG{p}{,} \PYG{l+m+mf}{2.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}\PYG{p}{,} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{best\PYGZus{}time\PYGZus{}step}\PYG{p}{,}\PYG{n}{max\PYGZus{}force\PYGZus{}tolerance} \PYG{o}{=} \PYG{n}{get\PYGZus{}simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{(}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{system}\PYG{p}{,}\PYG{n}{positions}\PYG{p}{,}\PYG{n}{temperature}\PYG{p}{,}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{p}{,}\PYG{n}{time\PYGZus{}step\PYGZus{}list}\PYG{o}{=}\PYG{n}{time\PYGZus{}step\PYGZus{}list}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{minimize\_structure() (in module simulation.tools)@\spxentry{minimize\_structure()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.minimize_structure}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{minimize\_structure}}}{\emph{topology}, \emph{system}, \emph{positions}, \emph{temperature=Quantity(value=0.0}, \emph{unit=kelvin)}, \emph{simulation\_time\_step=None}, \emph{total\_simulation\_time=Quantity(value=1.0}, \emph{unit=picosecond)}, \emph{output\_pdb=None}, \emph{output\_data=None}, \emph{print\_frequency=1}}{}
Minimize the potential energy
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} (\sphinxstyleliteralemphasis{\sphinxupquote{Topology}}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} OpenMM topology

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} (\sphinxstyleliteralemphasis{\sphinxupquote{System}}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} OpenMM system

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} \textendash{} Positions array for the model we would like to test

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature}} \textendash{} Simulation temperature

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_pdb}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output destinaton for PDB-formatted coordinates during the simulation

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_data}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output destination for simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} Number of simulation steps to skip when writing data, default = 1

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
positions ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ( np.array( {[}cgmodel.num\_beads,3{]} ), simtk.unit ) ) - Minimized positions

\item {} 
potential\_energy ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} - Potential energy for the minimized structure.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mf}{300.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{kelvin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}simulation\PYGZus{}time} \PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{picosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}pdb} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}data} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.dat}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{print\PYGZus{}frequency} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{minimum\PYGZus{}energy\PYGZus{}structure}\PYG{p}{,}\PYG{n}{potential\PYGZus{}energy}\PYG{p}{,}\PYG{n}{openmm\PYGZus{}simulation\PYGZus{}object} \PYG{o}{=} \PYG{n}{minimize\PYGZus{}structure}\PYG{p}{(}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{system}\PYG{p}{,}\PYG{n}{positions}\PYG{p}{,}\PYG{n}{temperature}\PYG{o}{=}\PYG{n}{temperature}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{o}{=}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{,}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{o}{=}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{p}{,}\PYG{n}{output\PYGZus{}pdb}\PYG{o}{=}\PYG{n}{output\PYGZus{}pdb}\PYG{p}{,}\PYG{n}{output\PYGZus{}data}\PYG{o}{=}\PYG{n}{output\PYGZus{}data}\PYG{p}{,}\PYG{n}{print\PYGZus{}frequency}\PYG{o}{=}\PYG{n}{print\PYGZus{}frequency}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{read\_simulation\_data() (in module simulation.tools)@\spxentry{read\_simulation\_data()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.read_simulation_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{read\_simulation\_data}}}{\emph{simulation\_data\_file}, \emph{simulation\_time\_step}}{}
Read OpenMM simulation data
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_data\_file}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to file that will be read

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Time step to apply for the simulation data

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
data ( dict( “Simulation Time”: list,”Potential Energy”: list,”Kinetic Energy”: list,”Total Energy”: list,”Temperature”: list ) ) - A dictionary containing the simulation times, potential energies, kinetic energies, and total energies from an OpenMM simulation trajectory.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}data\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.dat}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{data} \PYG{o}{=} \PYG{n}{read\PYGZus{}simulation\PYGZus{}data}\PYG{p}{(}\PYG{n}{simulation\PYGZus{}data\PYGZus{}file}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\phantomsection\label{\detokenize{simulation:module-simulation.rep_exch}}\index{simulation.rep\_exch (module)@\spxentry{simulation.rep\_exch}\spxextra{module}}\index{get\_minimum\_energy\_ensemble() (in module simulation.rep\_exch)@\spxentry{get\_minimum\_energy\_ensemble()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.get_minimum_energy_ensemble}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{get\_minimum\_energy\_ensemble}}}{\emph{topology}, \emph{replica\_energies}, \emph{replica\_positions}, \emph{ensemble\_size=5}, \emph{file\_name=None}}{}
Get an ensemble of low (potential) energy poses, and write the lowest energy structure to a PDB file if a file\_name is provided.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_energies}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{float * simtk.unit.energy for simulation\_steps}}\sphinxstyleliteralemphasis{\sphinxupquote{ ) }}\sphinxstyleliteralemphasis{\sphinxupquote{for num\_replicas}}\sphinxstyleliteralemphasis{\sphinxupquote{ )}}) \textendash{} List of dimension num\_replicas X simulation\_steps, which gives the energies for all replicas at all simulation steps

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_positions}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{float * simtk.unit.positions for num\_beads}}\sphinxstyleliteralemphasis{\sphinxupquote{ ) }}\sphinxstyleliteralemphasis{\sphinxupquote{for simulation\_steps}}\sphinxstyleliteralemphasis{\sphinxupquote{ )}}) \textendash{} List of positions for all output frames for all replicas

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{file\_name}} \textendash{} Output destination for PDB coordinates of minimum energy pose, Default = None

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
ensemble ( List() ) - A list of poses that are in the minimum energy ensemble.

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{cg\PYGZus{}openmm}\PYG{n+nn}{.}\PYG{n+nn}{simulation}\PYG{n+nn}{.}\PYG{n+nn}{rep\PYGZus{}exch} \PYG{k}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{run\PYGZus{}replica\PYGZus{}exchange}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ensemble\PYGZus{}size} \PYG{o}{=} \PYG{l+m+mi}{5}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{file\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{minimum.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{minimum\PYGZus{}energy\PYGZus{}ensemble} \PYG{o}{=} \PYG{n}{get\PYGZus{}minimum\PYGZus{}energy\PYGZus{}ensemble}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{ensemble\PYGZus{}size}\PYG{o}{=}\PYG{n}{ensemble\PYGZus{}size}\PYG{p}{,}\PYG{n}{file\PYGZus{}name}\PYG{o}{=}\PYG{n}{file\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}



\chapter{Utilities for coarse grained modeling in OpenMM}
\label{\detokenize{utilities:utilities-for-coarse-grained-modeling-in-openmm}}\label{\detokenize{utilities::doc}}
This page details the functionality of utilities in cg\_openmm/src/utilities/util.py.

\phantomsection\label{\detokenize{utilities:module-utilities.util}}\index{utilities.util (module)@\spxentry{utilities.util}\spxextra{module}}\index{distance() (in module utilities.util)@\spxentry{distance()}\spxextra{in module utilities.util}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utilities:utilities.util.distance}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utilities.util.}}\sphinxbfcode{\sphinxupquote{distance}}}{\emph{positions\_1}, \emph{positions\_2}}{}
Calculate the distance between two particles, given their positions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions\_1}} (\sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ( np.array( {[}3{]} ), simtk.unit )) \textendash{} Positions for the first particle

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions\_2}} \textendash{} Positions for the first particle

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
distance ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()}) - Distance between two particles

\end{itemize}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{particle\PYGZus{}1\PYGZus{}coordinates} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{particle\PYGZus{}2\PYGZus{}coordinates} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{particle\PYGZus{}distance} \PYG{o}{=} \PYG{n}{distance}\PYG{p}{(}\PYG{n}{particle\PYGZus{}1\PYGZus{}coordinates}\PYG{p}{,}\PYG{n}{particle\PYGZus{}2\PYGZus{}coordinates}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_box\_vectors() (in module utilities.util)@\spxentry{get\_box\_vectors()}\spxextra{in module utilities.util}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utilities:utilities.util.get_box_vectors}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utilities.util.}}\sphinxbfcode{\sphinxupquote{get\_box\_vectors}}}{\emph{box\_size}}{}
Given a simulation box length, construct a vector.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{box\_size}} \textendash{} Length of individual sides of a simulation box

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
box\_vectors ( List( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ) ) - Vectors to use when defining an OpenMM simulation box.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{lj\_v() (in module utilities.util)@\spxentry{lj\_v()}\spxextra{in module utilities.util}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utilities:utilities.util.lj_v}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utilities.util.}}\sphinxbfcode{\sphinxupquote{lj\_v}}}{\emph{positions\_1}, \emph{positions\_2}, \emph{sigma}, \emph{epsilon}}{}
Calculate the Lennard-Jones interaction energy between two particles, given their positions and definitions for their equilbrium interaction distance (sigma) and strength (epsilon).
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions\_1}} \textendash{} Positions for the first particle

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions\_2}} \textendash{} Positions for the first particle

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{sigma}} \textendash{} Lennard-Jones equilibrium interaction distance for two non-bonded particles

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{epsilon}} \textendash{} Lennard-Jones equilibrium interaction energy for two non-bonded particles.

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
v ( \sphinxhref{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}{Quantity()} ) - Lennard-Jones interaction energy

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{set\_box\_vectors() (in module utilities.util)@\spxentry{set\_box\_vectors()}\spxextra{in module utilities.util}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utilities:utilities.util.set_box_vectors}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utilities.util.}}\sphinxbfcode{\sphinxupquote{set\_box\_vectors}}}{\emph{system}, \emph{box\_size}}{}
Impose a set of simulation box vectors on an OpenMM simulation object.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} (\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()}) \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{box\_size}} \textendash{} Length of individual sides of a simulation box

\end{itemize}

\item[{Returns}] \leavevmode
\begin{itemize}
\item {} 
system (\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()}) - OpenMM system object

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{b}
\item\relax\sphinxstyleindexentry{build.cg\_build}\sphinxstyleindexpageref{build:\detokenize{module-build.cg_build}}
\indexspace
\bigletter{s}
\item\relax\sphinxstyleindexentry{simulation.rep\_exch}\sphinxstyleindexpageref{simulation:\detokenize{module-simulation.rep_exch}}
\item\relax\sphinxstyleindexentry{simulation.tools}\sphinxstyleindexpageref{simulation:\detokenize{module-simulation.tools}}
\indexspace
\bigletter{u}
\item\relax\sphinxstyleindexentry{utilities.util}\sphinxstyleindexpageref{utilities:\detokenize{module-utilities.util}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}