%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,12pt,english,openany,oneside]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{Coarse-grained OpenMM Documentation}
\date{Sep 04, 2019}
\release{0.0.1}
\author{Garrett A. Meek\\ \\Michael R. Shirts\\ \\Dept. of Chemical and Biological Engineering\\University of Colorado Boulder}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


This documentation is generated automatically using Sphinx, which reads all docstring-formatted comments from Python functions in the ‘cg\_openmm’ repository.  (See cg\_openmm/doc for Sphinx source files.)


\chapter{Building OpenMM objects for coarse grained modeling}
\label{\detokenize{build:building-openmm-objects-for-coarse-grained-modeling}}\label{\detokenize{build::doc}}

\section{Building an OpenMM System() and Topology()}
\label{\detokenize{build:building-an-openmm-system-and-topology}}
All OpenMM simulations require a \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()} and a \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1topology\_1\_1Topology.html}{Topology()}.

Listed below are functions and classes that aid the building of OpenMM System() and Topology() class objects for coarse grained models with user-defined properties:


\section{Other tools for building and verifying the OpenMM System() and Topology()}
\label{\detokenize{build:other-tools-for-building-and-verifying-the-openmm-system-and-topology}}
Shown below are other functions/tools to build and verify the System/Topology:


\chapter{OpenMM simulation tools for coarse grained modeling}
\label{\detokenize{simulation:openmm-simulation-tools-for-coarse-grained-modeling}}\label{\detokenize{simulation::doc}}

\section{Building OpenMM simulation objects}
\label{\detokenize{simulation:building-openmm-simulation-objects}}
OpenMM simulations are propagated using a \sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1simulation\_1\_1Simulation.html}{Simulation()} object.

Shown below are the main tools needed to build OpenMM Simulaton() objects for coarse grained modeling.

\phantomsection\label{\detokenize{simulation:module-simulation.tools}}\index{simulation.tools (module)@\spxentry{simulation.tools}\spxextra{module}}\index{build\_mm\_simulation() (in module simulation.tools)@\spxentry{build\_mm\_simulation()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.build_mm_simulation}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{build\_mm\_simulation}}}{\emph{topology}, \emph{system}, \emph{positions}, \emph{temperature=Quantity(value=300.0}, \emph{unit=kelvin)}, \emph{simulation\_time\_step=None}, \emph{total\_simulation\_time=Quantity(value=1.0}, \emph{unit=picosecond)}, \emph{output\_pdb=None}, \emph{output\_data=None}, \emph{print\_frequency=100}, \emph{test\_time\_step=False}}{}
Build an OpenMM Simulation()
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} (\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1topology\_1\_1Topology.html}{Topology()}) \textendash{} OpenMM Topology()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} (\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()}) \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{https://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}cgmodel.num\_beads,3{]}),simtk.unit)) \textendash{} Positions array for the model we would like to test

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature}} (\sphinxhref{https://simtk.org/}{SIMTK} \sphinxhref{http://docs.openmm.org/7.1.0/api-python/generated/simtk.unit.unit.Unit.html}{Unit()}) \textendash{} Simulation temperature, default = 300.0 K

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_pdb}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output destination for PDB coordinates, Default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_data}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output destination for non-coordinate simulation data, Default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} \textendash{} Number of simulation steps to skip when writing to output, Default = 100

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{test\_time\_step}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Logical variable determining if a test of the time step will be performed, Default = False

\end{itemize}

\item[{Returns}] \leavevmode
OpenMM Simulation() object

\item[{Return type}] \leavevmode

\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1app\_1\_1simulation\_1\_1Simulation.html}{Simulation()}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mf}{300.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{kelvin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{picosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}pdb} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}data} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.dat}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{print\PYGZus{}frequency} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{openmm\PYGZus{}simulation} \PYG{o}{=} \PYG{n}{build\PYGZus{}mm\PYGZus{}simulation}\PYG{p}{(}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{system}\PYG{p}{,}\PYG{n}{positions}\PYG{p}{,}\PYG{n}{temperature}\PYG{o}{=}\PYG{n}{temperature}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{o}{=}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{,}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{o}{=}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{p}{,}\PYG{n}{output\PYGZus{}pdb}\PYG{o}{=}\PYG{n}{output\PYGZus{}pdb}\PYG{p}{,}\PYG{n}{output\PYGZus{}data}\PYG{o}{=}\PYG{n}{output\PYGZus{}data}\PYG{p}{,}\PYG{n}{print\PYGZus{}frequency}\PYG{o}{=}\PYG{n}{print\PYGZus{}frequency}\PYG{p}{,}\PYG{n}{test\PYGZus{}time\PYGZus{}step}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{run\_simulation() (in module simulation.tools)@\spxentry{run\_simulation()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.run_simulation}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{run\_simulation}}}{\emph{cgmodel}, \emph{output\_directory}, \emph{total\_simulation\_time}, \emph{simulation\_time\_step}, \emph{temperature}, \emph{print\_frequency}, \emph{output\_pdb=None}, \emph{output\_data=None}}{}
Run OpenMM() simulation
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{cgmodel}} (\sphinxstyleliteralemphasis{\sphinxupquote{class}}) \textendash{} CGModel() object

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_directory}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output directory for simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature}} \textendash{} Simulation temperature, default = 300.0 K

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} \textendash{} Number of simulation steps to skip when writing to output, Default = 100

\end{itemize}

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mf}{300.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{kelvin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{picosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}directory} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{getcwd}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}pdb} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}data} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.dat}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{print\PYGZus{}frequency} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{run\PYGZus{}simulation}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{p}{,}\PYG{n}{output\PYGZus{}directory}\PYG{p}{,}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{,}\PYG{n}{temperature}\PYG{p}{,}\PYG{n}{print\PYGZus{}frequency}\PYG{p}{,}\PYG{n}{output\PYGZus{}pdb}\PYG{o}{=}\PYG{n}{output\PYGZus{}pdb}\PYG{p}{,}\PYG{n}{output\PYGZus{}data}\PYG{o}{=}\PYG{n}{output\PYGZus{}data}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{warning}{Warning:}
When run with default options this subroutine is capable of producing a large number of output files.  For example, by default this subroutine will plot the simulation data that is written to an output file.
\end{sphinxadmonition}

\end{fulllineitems}



\section{Building and running Yank replica exchange simulations}
\label{\detokenize{simulation:building-and-running-yank-replica-exchange-simulations}}
The \sphinxhref{http://getyank.org/0.23.4/index.html}{Yank} python package is used to perform replica exchange sampling with OpenMM simulations.

Shown below are the main functions and tools necessary to conduct Yank replica exchange simulations with a coarse grained model in OpenMM.

\phantomsection\label{\detokenize{simulation:module-simulation.rep_exch}}\index{simulation.rep\_exch (module)@\spxentry{simulation.rep\_exch}\spxextra{module}}\index{run\_replica\_exchange() (in module simulation.rep\_exch)@\spxentry{run\_replica\_exchange()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.run_replica_exchange}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{run\_replica\_exchange}}}{\emph{topology, system, positions, temperature\_list={[}Quantity(value=250.0, unit=kelvin), Quantity(value=260.0, unit=kelvin), Quantity(value=270.0, unit=kelvin), Quantity(value=280.0, unit=kelvin), Quantity(value=290.0, unit=kelvin), Quantity(value=300.0, unit=kelvin), Quantity(value=310.0, unit=kelvin), Quantity(value=320.0, unit=kelvin), Quantity(value=330.0, unit=kelvin), Quantity(value=340.0, unit=kelvin){]}, simulation\_time\_step=None, total\_simulation\_time=Quantity(value=1.0, unit=picosecond), output\_data='output.nc', print\_frequency=100, verbose\_simulation=False, exchange\_attempts=None, test\_time\_step=False}}{}
Run a Yank replica exchange simulation using an OpenMM coarse grained model.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}cgmodel.num\_beads,3{]}),simtk.unit)) \textendash{} Positions array for the model we would like to test

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_list}} \textendash{} List of temperatures for which to perform replica exchange simulations, default = {[}(300.0 * unit.kelvin).\_\_add\_\_(i * unit.kelvin) for i in range(-20,100,10){]}

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{string}}) \textendash{} Name of NETCDF file where we will write simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} \textendash{} Number of simulation steps to skip when writing to output, Default = 100

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{verbose\_simulation}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Determines how much output is printed during a simulation run.  Default = False

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{exchange\_attempts}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} Number of exchange attempts to make during a replica exchange simulation run, Default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{test\_time\_step}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Logical variable determining if a test of the time step will be performed, Default = False

\end{itemize}

\item[{Returns}] \leavevmode
replica\_energies: The potential energies for all replicas at all (printed) time steps

\item[{Return type}] \leavevmode
replica\_energies: {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.float({[}number\_replicas,number\_simulation\_steps{]}),simtk.unit)

\item[{Returns}] \leavevmode
replica\_positions: The positions for all replicas at all (printed) time steps

\item[{Return type}] \leavevmode
replica\_positions: {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.float({[}number\_replicas,number\_simulation\_steps,cgmodel.num\_beads,3{]}),simtk.unit)

\item[{Returns}] \leavevmode
replica\_state\_indices: The thermodynamic state assignments for all replicas at all (printed) time steps

\item[{Return type}] \leavevmode
replica\_state\_indices: {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.int64({[}number\_replicas,number\_simulation\_steps{]}),simtk.unit)

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{cg\PYGZus{}openmm}\PYG{n+nn}{.}\PYG{n+nn}{simulation}\PYG{n+nn}{.}\PYG{n+nn}{rep\PYGZus{}exch} \PYG{k}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{run\PYGZus{}replica\PYGZus{}exchange}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{read\_replica\_exchange\_data() (in module simulation.rep\_exch)@\spxentry{read\_replica\_exchange\_data()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.read_replica_exchange_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{read\_replica\_exchange\_data}}}{\emph{system=None}, \emph{topology=None}, \emph{temperature\_list=None}, \emph{output\_data='output.nc'}, \emph{print\_frequency=None}}{}
Read replica exchange simulation data.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} \textendash{} OpenMM system object, default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM topology object, default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_list}} \textendash{} List of temperatures that will be used to define different replicas (thermodynamics states), default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_data}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to the output data for a Yank, NetCDF-formatted file containing replica exchange simulation data, default = None

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} Number of simulation steps to skip when writing data, default = None

\end{itemize}

\item[{Returns}] \leavevmode
replica\_energies: The potential energies for all replicas at all (printed) time steps

\item[{Return type}] \leavevmode
replica\_energies: {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.float({[}number\_replicas,number\_simulation\_steps{]}),simtk.unit)

\item[{Returns}] \leavevmode
replica\_positions: The positions for all replicas at all (printed) time steps

\item[{Return type}] \leavevmode
replica\_positions: {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.float({[}number\_replicas,number\_simulation\_steps,cgmodel.num\_beads,3{]}),simtk.unit)

\item[{Returns}] \leavevmode
replica\_state\_indices: The thermodynamic state assignments for all replicas at all (printed) time steps

\item[{Return type}] \leavevmode
replica\_state\_indices: {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.int64({[}number\_replicas,number\_simulation\_steps{]}),simtk.unit)

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{cg\PYGZus{}openmm}\PYG{n+nn}{.}\PYG{n+nn}{simulation}\PYG{n+nn}{.}\PYG{n+nn}{rep\PYGZus{}exch} \PYG{k}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{run\PYGZus{}replica\PYGZus{}exchange}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{read\PYGZus{}replica\PYGZus{}exchange\PYGZus{}data}\PYG{p}{(}\PYG{n}{system}\PYG{o}{=}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{topology}\PYG{o}{=}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{temperature\PYGZus{}list}\PYG{o}{=}\PYG{p}{,}\PYG{n}{output\PYGZus{}data}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.nc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{print\PYGZus{}frequency}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{make\_replica\_pdb\_files() (in module simulation.rep\_exch)@\spxentry{make\_replica\_pdb\_files()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.make_replica_pdb_files}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{make\_replica\_pdb\_files}}}{\emph{topology}, \emph{replica\_positions}}{}
Make PDB files from replica exchange simulation trajectory data
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_positions}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}n\_replicas,cgmodel.num\_beads,3{]}),simtk.unit)) \textendash{} Positions array for the replica exchange data for which we will write PDB files

\end{itemize}

\item[{Returns}] \leavevmode
file\_list: A list of names for the files that were written.

\item[{Return type}] \leavevmode
List( \sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{str} )

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{cg\PYGZus{}openmm}\PYG{n+nn}{.}\PYG{n+nn}{simulation}\PYG{n+nn}{.}\PYG{n+nn}{rep\PYGZus{}exch} \PYG{k}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{run\PYGZus{}replica\PYGZus{}exchange}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{pdb\PYGZus{}file\PYGZus{}list} \PYG{o}{=} \PYG{n}{make\PYGZus{}replica\PYGZus{}pdb\PYGZus{}files}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}



\section{Plotting tools}
\label{\detokenize{simulation:plotting-tools}}
Shown below are functions which allow plotting of simulation results.

\phantomsection\label{\detokenize{simulation:module-simulation.rep_exch}}\index{simulation.rep\_exch (module)@\spxentry{simulation.rep\_exch}\spxextra{module}}\index{plot\_replica\_exchange\_energies() (in module simulation.rep\_exch)@\spxentry{plot\_replica\_exchange\_energies()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.plot_replica_exchange_energies}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{plot\_replica\_exchange\_energies}}}{\emph{replica\_energies}, \emph{temperature\_list}, \emph{simulation\_time\_step}, \emph{steps\_per\_stage=1}, \emph{file\_name='replica\_exchange\_energies.png'}, \emph{legend=True}}{}
Plot the potential energies for a batch of replica exchange trajectories
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_energies}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{float * simtk.unit.energy for simulation\_steps}}\sphinxstyleliteralemphasis{\sphinxupquote{ ) }}\sphinxstyleliteralemphasis{\sphinxupquote{for num\_replicas}}\sphinxstyleliteralemphasis{\sphinxupquote{ )}}) \textendash{} List of dimension num\_replicas X simulation\_steps, which gives the energies for all replicas at all simulation steps

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_list}} \textendash{} List of temperatures for which to perform replica exchange simulations, default = {[}(300.0 * unit.kelvin).\_\_add\_\_(i * unit.kelvin) for i in range(-20,100,10){]}

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{steps\_per\_stage}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} The number of simulation steps for individual replica “stages” (period of time between state exchanges), default = 1

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{file\_name}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} The pathname of the output file for plotting results, default = “replica\_exchange\_energies.png”

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{legend}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Controls whether a legend is added to the plot

\end{itemize}

\end{description}\end{quote}

..warning:: If more than 10 replica exchange trajectories are provided as input data, by default, this function will only plot the first 10 thermodynamic states.  These thermodynamic states are chosen based upon their indices, not their instantaneous temperature (ensemble) assignment.

\end{fulllineitems}

\index{plot\_replica\_exchange\_summary() (in module simulation.rep\_exch)@\spxentry{plot\_replica\_exchange\_summary()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.plot_replica_exchange_summary}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{plot\_replica\_exchange\_summary}}}{\emph{replica\_states}, \emph{temperature\_list}, \emph{simulation\_time\_step}, \emph{steps\_per\_stage=1}, \emph{file\_name='replica\_exchange\_state\_transitions.png'}, \emph{legend=True}}{}
Plot the thermodynamic state assignments for individual temperature replicas as a function of the simulation time, in order to obtain a visual summary of the replica exchanges from a Yank simulation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_states}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{float * simtk.unit.energy for simulation\_steps}}\sphinxstyleliteralemphasis{\sphinxupquote{ ) }}\sphinxstyleliteralemphasis{\sphinxupquote{for num\_replicas}}\sphinxstyleliteralemphasis{\sphinxupquote{ )}}) \textendash{} List of dimension num\_replicas X simulation\_steps, which gives the thermodynamic state indices for all replicas at all simulation steps

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_list}} \textendash{} List of temperatures for which to perform replica exchange simulations, default = {[}(300.0 * unit.kelvin).\_\_add\_\_(i * unit.kelvin) for i in range(-20,100,10){]}

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{steps\_per\_stage}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} The number of simulation steps for individual replica “stages” (period of time between state exchanges), default = 1

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{file\_name}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} The pathname of the output file for plotting results, default = “replica\_exchange\_state\_transitions.png”

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{legend}} (\sphinxstyleliteralemphasis{\sphinxupquote{Logical}}) \textendash{} Controls whether a legend is added to the plot

\end{itemize}

\end{description}\end{quote}

..warning:: If more than 10 replica exchange trajectories are provided as input data, by default, this function will only plot the first 10 thermodynamic states.  These thermodynamic states are chosen based upon their indices, not their instantaneous temperature (ensemble) assignment.

\end{fulllineitems}

\phantomsection\label{\detokenize{simulation:module-simulation.tools}}\index{simulation.tools (module)@\spxentry{simulation.tools}\spxextra{module}}\index{plot\_simulation\_data() (in module simulation.tools)@\spxentry{plot\_simulation\_data()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.plot_simulation_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{plot\_simulation\_data}}}{\emph{simulation\_times}, \emph{y\_data}, \emph{plot\_type=None}}{}
Plot simulation data.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_times}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} List of simulation times (x data)

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{y\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}) \textendash{} List of simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{plot\_type}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Form of data to plot, Default = None, Valid options include: “Potential Energy”, “Kinetic Energy”, “Total Energy”, “Temperature”

\end{itemize}

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}data\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}data} \PYG{o}{=} \PYG{n}{read\PYGZus{}simulation\PYGZus{}data}\PYG{p}{(}\PYG{n}{simulation\PYGZus{}data\PYGZus{}file}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}times} \PYG{o}{=} \PYG{n}{simulation\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Simulation Time}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{y\PYGZus{}data} \PYG{o}{=} \PYG{n}{simulation\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Potential Energy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{plot\PYGZus{}type} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Potential Energy}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{plot\PYGZus{}simulation\PYGZus{}data}\PYG{p}{(}\PYG{n}{simulation\PYGZus{}times}\PYG{p}{,}\PYG{n}{y\PYGZus{}data}\PYG{p}{,}\PYG{n}{plot\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Potential Energy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{plot\_simulation\_results() (in module simulation.tools)@\spxentry{plot\_simulation\_results()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.plot_simulation_results}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{plot\_simulation\_results}}}{\emph{simulation\_data\_file}, \emph{plot\_output\_directory}, \emph{simulation\_time\_step}}{}
Plot all data from an OpenMM output file
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_data\_file}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to file containing simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{plot\_output\_directory}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to folder where plotting results will be written.

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Simulation integration time step

\end{itemize}

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}data\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{plot\PYGZus{}output\PYGZus{}directory} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{getcwd}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{plot\PYGZus{}simulation\PYGZus{}results}\PYG{p}{(}\PYG{n}{simulation\PYGZus{}data\PYGZus{}file}\PYG{p}{,}\PYG{n}{plot\PYGZus{}output\PYGZus{}directory}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}



\section{Other simulation tools}
\label{\detokenize{simulation:other-simulation-tools}}
Shown below are other tools which aid the building and verification of OpenMM simulation objects.

\phantomsection\label{\detokenize{simulation:module-simulation.tools}}\index{simulation.tools (module)@\spxentry{simulation.tools}\spxextra{module}}\index{get\_mm\_energy() (in module simulation.tools)@\spxentry{get\_mm\_energy()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.get_mm_energy}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{get\_mm\_energy}}}{\emph{topology}, \emph{system}, \emph{positions}}{}
Get the OpenMM potential energy for a system, given a topology and set of positions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}cgmodel.num\_beads,3{]}),simtk.unit)) \textendash{} Positions array for the model we would like to test

\end{itemize}

\item[{Returns}] \leavevmode
potential\_energy: The potential energy for the model with the provided positions.

\item[{Return type}] \leavevmode
{\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(float,simtk.unit)

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{openmm\PYGZus{}potential\PYGZus{}energy} \PYG{o}{=} \PYG{n}{get\PYGZus{}mm\PYGZus{}energy}\PYG{p}{(}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{system}\PYG{p}{,}\PYG{n}{positions}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_simulation\_time\_step() (in module simulation.tools)@\spxentry{get\_simulation\_time\_step()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.get_simulation_time_step}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{get\_simulation\_time\_step}}}{\emph{topology}, \emph{system}, \emph{positions}, \emph{temperature}, \emph{total\_simulation\_time}, \emph{time\_step\_list=None}}{}
Determine a suitable simulation time step.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}cgmodel.num\_beads,3{]}),simtk.unit)) \textendash{} Positions array for the model we would like to test

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature}} \textendash{} Simulation temperature

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{time\_step\_list}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default = None}}) \textendash{} List of time steps for which to attempt a simulation in OpenMM.

\end{itemize}

\item[{Returns}] \leavevmode
A successfully-tested time step

\item[{Return type}] \leavevmode

\sphinxhref{https://simtk.org/}{SIMTK} \sphinxhref{http://docs.openmm.org/7.1.0/api-python/generated/simtk.unit.unit.Unit.html}{Unit()}


\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mf}{300.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{kelvin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}simulation\PYGZus{}time} \PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{picosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{time\PYGZus{}step\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}\PYG{p}{,} \PYG{l+m+mf}{2.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}\PYG{p}{,} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{best\PYGZus{}time\PYGZus{}step}\PYG{p}{,}\PYG{n}{max\PYGZus{}force\PYGZus{}tolerance} \PYG{o}{=} \PYG{n}{get\PYGZus{}simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{(}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{system}\PYG{p}{,}\PYG{n}{positions}\PYG{p}{,}\PYG{n}{temperature}\PYG{p}{,}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{p}{,}\PYG{n}{time\PYGZus{}step\PYGZus{}list}\PYG{o}{=}\PYG{n}{time\PYGZus{}step\PYGZus{}list}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{minimize\_structure() (in module simulation.tools)@\spxentry{minimize\_structure()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.minimize_structure}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{minimize\_structure}}}{\emph{topology}, \emph{system}, \emph{positions}, \emph{temperature=Quantity(value=0.0}, \emph{unit=kelvin)}, \emph{simulation\_time\_step=None}, \emph{total\_simulation\_time=Quantity(value=1.0}, \emph{unit=picosecond)}, \emph{output\_pdb=None}, \emph{output\_data=None}, \emph{print\_frequency=1}}{}
Minimize the potential energy
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} (\sphinxstyleliteralemphasis{\sphinxupquote{Topology}}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} OpenMM topology

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} (\sphinxstyleliteralemphasis{\sphinxupquote{System}}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} OpenMM system

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}cgmodel.num\_beads,3{]}),simtk.unit)) \textendash{} Positions array for the model we would like to test

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{temperature}} \textendash{} Simulation temperature

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{total\_simulation\_time}} \textendash{} Total run time for individual simulations

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_pdb}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output destinaton for PDB-formatted coordinates during the simulation

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{output\_data}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Output destination for simulation data

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{print\_frequency}} (\sphinxhref{https://docs.python.org/3/library/functions.html\#int}{\sphinxstyleliteralemphasis{\sphinxupquote{int}}}) \textendash{} Number of simulation steps to skip when writing data, default = 1

\end{itemize}

\item[{Returns}] \leavevmode
positions: Minimized positions

\item[{Return type}] \leavevmode
positions: {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}cgmodel.num\_beads,3{]}),simtk.unit)

\item[{Returns}] \leavevmode
potential\_energy: Potential energy for the minimized structure.

\item[{Return type}] \leavevmode
potential\_energy: {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}cgmodel.num\_beads,3{]}),simtk.unit)

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{topology} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{system} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{positions} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{temperature} \PYG{o}{=} \PYG{l+m+mf}{300.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{kelvin}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{total\PYGZus{}simulation\PYGZus{}time} \PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{picosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{1.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}pdb} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{output\PYGZus{}data} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.dat}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{print\PYGZus{}frequency} \PYG{o}{=} \PYG{l+m+mi}{20}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{minimum\PYGZus{}energy\PYGZus{}structure}\PYG{p}{,}\PYG{n}{potential\PYGZus{}energy}\PYG{p}{,}\PYG{n}{openmm\PYGZus{}simulation\PYGZus{}object} \PYG{o}{=} \PYG{n}{minimize\PYGZus{}structure}\PYG{p}{(}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{system}\PYG{p}{,}\PYG{n}{positions}\PYG{p}{,}\PYG{n}{temperature}\PYG{o}{=}\PYG{n}{temperature}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{o}{=}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{,}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{o}{=}\PYG{n}{total\PYGZus{}simulation\PYGZus{}time}\PYG{p}{,}\PYG{n}{output\PYGZus{}pdb}\PYG{o}{=}\PYG{n}{output\PYGZus{}pdb}\PYG{p}{,}\PYG{n}{output\PYGZus{}data}\PYG{o}{=}\PYG{n}{output\PYGZus{}data}\PYG{p}{,}\PYG{n}{print\PYGZus{}frequency}\PYG{o}{=}\PYG{n}{print\PYGZus{}frequency}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{read\_simulation\_data() (in module simulation.tools)@\spxentry{read\_simulation\_data()}\spxextra{in module simulation.tools}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.tools.read_simulation_data}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.tools.}}\sphinxbfcode{\sphinxupquote{read\_simulation\_data}}}{\emph{simulation\_data\_file}, \emph{simulation\_time\_step}}{}
Read OpenMM simulation data
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_data\_file}} (\sphinxhref{https://docs.python.org/3/library/stdtypes.html\#str}{\sphinxstyleliteralemphasis{\sphinxupquote{str}}}) \textendash{} Path to file that will be read

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{simulation\_time\_step}} \textendash{} Time step to apply for the simulation data

\end{itemize}

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{simtk} \PYG{k}{import} \PYG{n}{unit}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}data\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{output.dat}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{simulation\PYGZus{}time\PYGZus{}step} \PYG{o}{=} \PYG{l+m+mf}{5.0} \PYG{o}{*} \PYG{n}{unit}\PYG{o}{.}\PYG{n}{femtosecond}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{data} \PYG{o}{=} \PYG{n}{read\PYGZus{}simulation\PYGZus{}data}\PYG{p}{(}\PYG{n}{simulation\PYGZus{}data\PYGZus{}file}\PYG{p}{,}\PYG{n}{simulation\PYGZus{}time\PYGZus{}step}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\phantomsection\label{\detokenize{simulation:module-simulation.rep_exch}}\index{simulation.rep\_exch (module)@\spxentry{simulation.rep\_exch}\spxextra{module}}\index{get\_minimum\_energy\_ensemble() (in module simulation.rep\_exch)@\spxentry{get\_minimum\_energy\_ensemble()}\spxextra{in module simulation.rep\_exch}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{simulation:simulation.rep_exch.get_minimum_energy_ensemble}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{simulation.rep\_exch.}}\sphinxbfcode{\sphinxupquote{get\_minimum\_energy\_ensemble}}}{\emph{topology}, \emph{replica\_energies}, \emph{replica\_positions}, \emph{ensemble\_size=5}, \emph{file\_name=None}}{}
Get an ensemble of low (potential) energy poses, and write the lowest energy structure to a PDB file if a file\_name is provided.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{topology}} \textendash{} OpenMM Topology()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_energies}} (\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{List}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{float * simtk.unit.energy for simulation\_steps}}\sphinxstyleliteralemphasis{\sphinxupquote{ ) }}\sphinxstyleliteralemphasis{\sphinxupquote{for num\_replicas}}\sphinxstyleliteralemphasis{\sphinxupquote{ )}}) \textendash{} List of dimension num\_replicas X simulation\_steps, which gives the energies for all replicas at all simulation steps

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{replica\_positions}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{( }}\sphinxstyleliteralemphasis{\sphinxupquote{float * simtk.unit.positions for num\_beads}}\sphinxstyleliteralemphasis{\sphinxupquote{ ) }}\sphinxstyleliteralemphasis{\sphinxupquote{for simulation\_steps}}\sphinxstyleliteralemphasis{\sphinxupquote{ )}}) \textendash{} List of positions for all output frames for all replicas

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{file\_name}} \textendash{} Output destination for PDB coordinates of minimum energy pose, Default = None

\end{itemize}

\item[{Returns}] \leavevmode
ensemble: A list of poses that are in the minimum energy ensemble.

\item[{Return type}] \leavevmode
List ( np.array( ( float * simtk.unit.positions for num\_beads ) for simulation\_steps ) )

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{cg\PYGZus{}openmm}\PYG{n+nn}{.}\PYG{n+nn}{simulation}\PYG{n+nn}{.}\PYG{n+nn}{rep\PYGZus{}exch} \PYG{k}{import} \PYG{o}{*}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{replica\PYGZus{}state\PYGZus{}indices} \PYG{o}{=} \PYG{n}{run\PYGZus{}replica\PYGZus{}exchange}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{system}\PYG{p}{,}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{ensemble\PYGZus{}size} \PYG{o}{=} \PYG{l+m+mi}{5}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{file\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{minimum.pdb}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{minimum\PYGZus{}energy\PYGZus{}ensemble} \PYG{o}{=} \PYG{n}{get\PYGZus{}minimum\PYGZus{}energy\PYGZus{}ensemble}\PYG{p}{(}\PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{topology}\PYG{p}{,}\PYG{n}{replica\PYGZus{}energies}\PYG{p}{,}\PYG{n}{replica\PYGZus{}positions}\PYG{p}{,}\PYG{n}{ensemble\PYGZus{}size}\PYG{o}{=}\PYG{n}{ensemble\PYGZus{}size}\PYG{p}{,}\PYG{n}{file\PYGZus{}name}\PYG{o}{=}\PYG{n}{file\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}



\chapter{Utilities for coarse grained modeling in OpenMM}
\label{\detokenize{utilities:utilities-for-coarse-grained-modeling-in-openmm}}\label{\detokenize{utilities::doc}}
This page details the functionality of utilities in cg\_openmm/src/utilities/util.py.

\phantomsection\label{\detokenize{utilities:module-utilities.util}}\index{utilities.util (module)@\spxentry{utilities.util}\spxextra{module}}\index{distance() (in module utilities.util)@\spxentry{distance()}\spxextra{in module utilities.util}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utilities:utilities.util.distance}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utilities.util.}}\sphinxbfcode{\sphinxupquote{distance}}}{\emph{positions\_1}, \emph{positions\_2}}{}
Calculate the distance between two particles, given their positions.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions\_1}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}3{]}),simtk.unit)) \textendash{} Positions for the first particle

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{positions\_2}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(np.array({[}3{]}),simtk.unit)) \textendash{} Positions for the first particle

\end{itemize}

\item[{Returns}] \leavevmode
distance: Distance between two particles

\item[{Return type}] \leavevmode
{\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(float,simtk.unit)

\item[{Example}] \leavevmode
\end{description}\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k+kn}{from} \PYG{n+nn}{foldamers}\PYG{n+nn}{.}\PYG{n+nn}{cg\PYGZus{}model}\PYG{n+nn}{.}\PYG{n+nn}{cgmodel} \PYG{k}{import} \PYG{n}{CGModel}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{cgmodel} \PYG{o}{=} \PYG{n}{CGModel}\PYG{p}{(}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{particle\PYGZus{}1\PYGZus{}coordinates} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{particle\PYGZus{}2\PYGZus{}coordinates} \PYG{o}{=} \PYG{n}{cgmodel}\PYG{o}{.}\PYG{n}{positions}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{particle\PYGZus{}distance} \PYG{o}{=} \PYG{n}{distance}\PYG{p}{(}\PYG{n}{particle\PYGZus{}1\PYGZus{}coordinates}\PYG{p}{,}\PYG{n}{particle\PYGZus{}2\PYGZus{}coordinates}\PYG{p}{)}
\end{sphinxVerbatim}

\end{fulllineitems}

\index{get\_box\_vectors() (in module utilities.util)@\spxentry{get\_box\_vectors()}\spxextra{in module utilities.util}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utilities:utilities.util.get_box_vectors}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utilities.util.}}\sphinxbfcode{\sphinxupquote{get\_box\_vectors}}}{\emph{box\_size}}{}
Given a simulation box length, construct a vector.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode
\sphinxstyleliteralstrong{\sphinxupquote{box\_size}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(float,simtk.unit)) \textendash{} Length of individual sides of a simulation box

\item[{Returns}] \leavevmode
box\_vectors: Vectors to use when defining an OpenMM simulation box.

\item[{Return type}] \leavevmode
box\_vectors: List( {\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(float,simtk.unit) )

\end{description}\end{quote}

\end{fulllineitems}

\index{lj\_v() (in module utilities.util)@\spxentry{lj\_v()}\spxextra{in module utilities.util}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utilities:utilities.util.lj_v}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utilities.util.}}\sphinxbfcode{\sphinxupquote{lj\_v}}}{\emph{positions\_1}, \emph{positions\_2}, \emph{sigma}, \emph{epsilon}}{}
\end{fulllineitems}

\index{set\_box\_vectors() (in module utilities.util)@\spxentry{set\_box\_vectors()}\spxextra{in module utilities.util}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{utilities:utilities.util.set_box_vectors}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{utilities.util.}}\sphinxbfcode{\sphinxupquote{set\_box\_vectors}}}{\emph{system}, \emph{box\_size}}{}
Impose a set of simulation box vectors on an OpenMM simulation object.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{system}} (\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()}) \textendash{} OpenMM System()

\item {} 
\sphinxstyleliteralstrong{\sphinxupquote{box\_size}} ({\color{red}\bfseries{}{}`}unit.Quantity() \textless{}\sphinxurl{http://docs.openmm.org/development/api-python/generated/simtk.unit.quantity.Quantity.html}\textgreater{}{}`\_(float,simtk.unit)) \textendash{} Length of individual sides of a simulation box

\end{itemize}

\item[{Returns}] \leavevmode
system: OpenMM system object

\item[{Return type}] \leavevmode

\sphinxhref{https://simtk.org/api\_docs/openmm/api4\_1/python/classsimtk\_1\_1openmm\_1\_1openmm\_1\_1System.html}{System()}


\end{description}\end{quote}

\end{fulllineitems}



\chapter{Indices and tables}
\label{\detokenize{index:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{s}
\item\relax\sphinxstyleindexentry{simulation.rep\_exch}\sphinxstyleindexpageref{simulation:\detokenize{module-simulation.rep_exch}}
\item\relax\sphinxstyleindexentry{simulation.tools}\sphinxstyleindexpageref{simulation:\detokenize{module-simulation.tools}}
\indexspace
\bigletter{u}
\item\relax\sphinxstyleindexentry{utilities.util}\sphinxstyleindexpageref{utilities:\detokenize{module-utilities.util}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}